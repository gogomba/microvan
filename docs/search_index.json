[["index.html", "Microvan About", " Microvan Hammond 2022-05-30 About The case describes a project by Grosse Pointe Associates (GPA) investigating the potential market for “microvans”. The objectives of this case are: 1. To give you experience segmenting customers in a market 2. To have you determine which segment(s) would be good to target based on analysis of the data. 3. To have you relate the segment(s) to demographic variables potentially useful for targeting "],["executive-summary.html", "Chapter1 Executive Summary", " Chapter1 Executive Summary The case describes a project by Grosse Pointe Associates (GPA) investigating the potential market for “microvans”. The objectives of this case are: 1. To give you experience segmenting customers in a market 2. To have you determine which segment(s) would be good to target based on analysis of the data. 3. To have you relate the segment(s) to demographic variables potentially useful for targeting. "],["explorative-data-analysis.html", "Chapter2 Explorative Data Analysis 2.1 Histogram 2.2 Correlation Analysis", " Chapter2 Explorative Data Analysis # multivariate analysis and basic descriptive statistics library(psych) # data processing library(dplyr) library(tidyverse) library(data.table) # plot library(ggplot2) library(corrplot) library(ggthemes) # rMarkdown library(rmarkdown) library(kableExtra) # file path management library(here) # stat library(factoextra) # data dataPath = file.path(dataDir, &quot;microvan.csv&quot;) microvan = read.csv(dataPath, sep=&quot;;&quot;) # Convert all integer variables into numeric ones for futher work microvan &lt;- as.data.table(lapply(microvan, as.numeric)) # data description description = psych::describe(microvan) %&gt;% as.data.frame() description ## vars n mean sd median trimmed mad min max ## subjnumb 1 400 200.5000 115.6143013 200.5 200.500000 148.2600 1 400 ## mvliking 2 400 4.8425 2.6899411 5.0 4.803125 2.9652 1 9 ## kidtrans 3 400 4.8250 1.5166164 5.0 4.800000 1.4826 1 9 ## miniboxy 4 400 4.6650 1.4775768 5.0 4.600000 1.4826 1 9 ## lthrbetr 5 400 4.2500 1.5176489 4.0 4.240625 1.4826 1 9 ## secbiggr 6 400 5.2275 1.5137610 5.0 5.256250 1.4826 1 9 ## safeimpt 7 400 4.9975 1.5126845 5.0 4.959375 1.4826 1 9 ## buyhghnd 8 400 5.2750 1.5444541 5.0 5.309375 1.4826 1 9 ## pricqual 9 400 4.9575 1.5170522 5.0 4.950000 1.4826 1 9 ## prmsound 10 400 4.7200 1.5057451 5.0 4.700000 1.4826 1 9 ## perfimpt 11 400 5.0000 1.4918324 5.0 4.971875 1.4826 1 9 ## tkvacatn 12 400 4.4400 1.5288045 5.0 4.446875 1.4826 1 9 ## noparkrm 13 400 4.5750 1.5182680 4.0 4.503125 1.4826 1 9 ## homlrgst 14 400 5.4925 1.5001900 5.0 5.462500 1.4826 1 9 ## envrminr 15 400 5.5325 1.5214239 6.0 5.562500 1.4826 1 9 ## needbetw 16 400 4.9400 1.5499697 5.0 4.912500 1.4826 1 9 ## suvcmpct 17 400 4.7825 1.5052769 5.0 4.731250 1.4826 1 9 ## next2str 18 400 4.4875 1.5510830 4.0 4.415625 1.4826 1 9 ## carefmny 19 400 5.2250 1.5281404 5.0 5.237500 1.4826 1 9 ## shdcarpl 20 400 5.1750 1.5033380 5.0 5.203125 1.4826 1 9 ## imprtapp 21 400 4.5600 1.5023457 5.0 4.568750 1.4826 1 9 ## lk4whldr 22 400 5.2350 1.4594863 5.0 5.268750 1.4826 1 9 ## kidsbulk 23 400 4.4775 1.4815469 4.0 4.415625 1.4826 1 9 ## wntguzlr 24 400 5.0600 1.5090039 5.0 5.062500 1.4826 1 9 ## nordtrps 25 400 5.3150 1.4920928 5.0 5.356250 1.4826 1 9 ## stylclth 26 400 5.3450 1.5270247 5.0 5.381250 1.4826 1 9 ## strngwrn 27 400 5.0425 1.5037776 5.0 5.059375 1.4826 1 9 ## passnimp 28 400 5.6150 1.5058033 6.0 5.628125 1.4826 1 9 ## twoincom 29 400 4.8725 1.5595912 5.0 4.868750 1.4826 1 9 ## nohummer 30 400 4.8525 1.5448982 5.0 4.815625 1.4826 1 9 ## aftrschl 31 400 4.3850 1.5058033 4.0 4.312500 1.4826 1 9 ## accesfun 32 400 4.6425 1.5249615 5.0 4.653125 1.4826 1 9 ## age 33 400 40.0550 8.5674078 40.0 40.068750 8.8956 19 60 ## income 34 400 71.2800 43.2847030 62.5 66.265625 42.2541 15 273 ## miles 35 400 18.0425 4.8646537 18.0 17.928125 4.4478 7 32 ## numkids 36 400 1.2200 1.0837603 1.0 1.100000 1.4826 0 4 ## female 37 400 0.5400 0.4990216 1.0 0.550000 0.0000 0 1 ## educ 38 400 2.8050 0.9322810 3.0 2.881250 1.4826 1 4 ## recycle 39 400 3.0400 1.1755231 3.0 3.050000 1.4826 1 5 ## range skew kurtosis se ## subjnumb 399 0.000000000 -1.209003675 5.78071507 ## mvliking 8 0.070991538 -1.202171094 0.13449706 ## kidtrans 8 0.180571278 -0.158456134 0.07583082 ## miniboxy 8 0.316581730 -0.100709380 0.07387884 ## lthrbetr 8 0.234942431 0.067537630 0.07588244 ## secbiggr 8 -0.184301606 -0.128696869 0.07568805 ## safeimpt 8 0.164565659 -0.047682745 0.07563422 ## buyhghnd 8 -0.170676842 -0.127985738 0.07722270 ## pricqual 8 0.058794979 -0.123184347 0.07585261 ## prmsound 8 0.037111505 -0.139989856 0.07528725 ## perfimpt 8 0.117463923 0.088952931 0.07459162 ## tkvacatn 8 0.157385518 -0.063799691 0.07644022 ## noparkrm 8 0.335294305 -0.171380468 0.07591340 ## homlrgst 8 -0.032243548 0.152175325 0.07500950 ## envrminr 8 -0.244778001 0.085106198 0.07607119 ## needbetw 8 0.115898983 -0.204947009 0.07749848 ## suvcmpct 8 0.261692312 -0.029620771 0.07526384 ## next2str 8 0.413183503 -0.119575276 0.07755415 ## carefmny 8 0.022777215 -0.352621649 0.07640702 ## shdcarpl 8 -0.130653599 0.046481706 0.07516690 ## imprtapp 8 0.103817964 -0.004093811 0.07511729 ## lk4whldr 8 -0.174001280 0.299606429 0.07297431 ## kidsbulk 8 0.408115144 0.172577332 0.07407734 ## wntguzlr 8 -0.018645331 -0.062515593 0.07545019 ## nordtrps 8 -0.185100977 0.079287200 0.07460464 ## stylclth 8 -0.177898625 -0.148610361 0.07635124 ## strngwrn 8 -0.089743287 0.004665614 0.07518888 ## passnimp 8 -0.262301769 0.189333416 0.07529017 ## twoincom 8 0.005960541 -0.130403030 0.07797956 ## nohummer 8 0.173352096 -0.154622579 0.07724491 ## aftrschl 8 0.459998292 0.109684308 0.07529017 ## accesfun 8 0.012988794 -0.237750130 0.07624807 ## age 41 -0.033077693 -0.721748240 0.42837039 ## income 258 1.178434029 1.730907696 2.16423515 ## miles 25 0.196120887 -0.315794159 0.24323269 ## numkids 4 0.735395049 -0.090571440 0.05418801 ## female 1 -0.159912918 -1.979357518 0.02495108 ## educ 3 -0.420102346 -0.669849007 0.04661405 ## recycle 4 -0.040305292 -0.833363634 0.05877616 2.1 Histogram microvan_df = microvan[,2:32] %&gt;% gather() microvan_hist = ggplot(microvan_df, aes(value)) + facet_wrap(~ key, scales = &quot;free&quot;,ncol = 6) + geom_histogram(alpha = 0.5, position = &quot;identity&quot;) + theme_economist_white() +theme(axis.title.x = element_blank()) microvan_hist_path = file.path(plotDir, &quot;microvan_hist.png&quot;) ggsave( filename =microvan_hist_path, plot = microvan_hist, width = 4000, height =4000, units = &quot;px&quot; ) ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. 2.2 Correlation Analysis 2.2.1 Pair-wise Scatter Plot 2.2.2 Correlation Matrix "],["exploratory-factor-analysis.html", "Chapter3 Exploratory Factor Analysis 3.1 Eigenvalues 3.2 Extract Principal Factors 3.3 Factor Loadings 3.4 Factor Scores", " Chapter3 Exploratory Factor Analysis 3.1 Eigenvalues # correlation analysis without mvliking cor&lt;- cor(vars[,-1]) EV = eigen(cor)$values EV_df = EV %&gt;% # convert to df as.data.frame()%&gt;% # name column dplyr::rename(., &quot;Eigen Value&quot; =&quot;.&quot;) %&gt;% # add a column &quot;Factor&quot; dplyr::mutate(Factor = seq(1,length(EV))) %&gt;% # order columns dplyr::select(Factor, everything()) %&gt;% # add a column &quot;Variance&quot; dplyr::mutate(`Variance %` = EV/length(EV) *100) %&gt;% dplyr::mutate(`Cumulative Variance % ` = cumsum(EV/length(EV))* 100) %&gt;% dplyr::mutate(., across(where(is.numeric), round, 1)) rmarkdown::paged_table(EV_df ) 3.1.1 Scree Plot psych::scree(cor, pc = TRUE, factors = FALSE) 3.1.2 Cumulative Percentages of Variance # Shares for the cumulative variance explained plot(cumsum(EV/length(EV)), type = &quot;o&quot;, # type of plot: &quot;o&quot; for points and lines &#39;overplotted&#39; col = &quot;darkblue&quot;, pch = 16, # plot symbol: 16 = filled circle cex = 1, # size of plot symbols xlab = &quot;Number of factors&quot;, # a title for the x axis ylab = &quot;Cumulative variance explained&quot;, # a title for the y axis lwd = 2) # line width abline(v = 5, lwd = 2, col = &quot;grey&quot;) # draw a vertical line at v = 3 3.1.3 Select Number of Factors using Kaiser Rule nFactor &lt;- length(which(EV &gt; 1)) print(paste0(nFactor, &quot; factors with Eigenvalue &gt; 1&quot; )) ## [1] &quot;5 factors with Eigenvalue &gt; 1&quot; 3.2 Extract Principal Factors EFA &lt;- psych::fa( r = cor, # number of factors nfactors = nFactor, # principal factor fm = &quot;pa&quot;, # maximizes the sum of the variance of the squared loadings rotate = &quot;varimax&quot; ) 3.3 Factor Loadings options(digits = 2) columnOrder &lt;- c(&quot;PA1&quot;, &quot;PA2&quot;, &quot;PA3&quot;, &quot;PA4&quot;,&quot;PA5&quot;,&quot;Communality&quot;,&quot;Uniqueness&quot;) EFA_loadings &lt;- data.frame(EFA$loadings[,] ) %&gt;% dplyr::mutate(Uniqueness = EFA$uniquenesses, Communality = EFA$communality) %&gt;% dplyr::mutate(., across(where(is.numeric), round, 2)) %&gt;% dplyr::select(columnOrder) %&gt;% arrange(., -Communality) ## Note: Using an external vector in selections is ambiguous. ## ℹ Use `all_of(columnOrder)` instead of `columnOrder` to silence this message. ## ℹ See &lt;https://tidyselect.r-lib.org/reference/faq-external-vector.html&gt;. ## This message is displayed once per session. # a function to highlight cells value &gt; 0.5 or &lt; -0.5 colorCell &lt;- function(x, n, nmax){ cell_spec(x, background = ifelse(is.na(as.numeric(x)), &quot;white&quot;, ifelse(n == nmax | n == 1, &quot;white&quot;, ifelse(abs(x) &gt;=0.5, &quot;lightgreen&quot;, ifelse(x &lt; 0.5, &quot;white&quot;, &quot;white&quot;))))) } # show table in rMarkdown EFA_loading_table = EFA_loadings %&gt;% mutate_all(funs(colorCell(., n = row_number(), nmax = n()))) %&gt;% kable(escape = FALSE) %&gt;% kable_styling(bootstrap_options = &quot;striped&quot;, full_width = F, position = &quot;center&quot;) ## Warning: `funs()` was deprecated in dplyr 0.8.0. ## Please use a list of either functions or lambdas: ## ## # Simple named list: ## list(mean = mean, median = median) ## ## # Auto named with `tibble::lst()`: ## tibble::lst(mean, median) ## ## # Using lambdas ## list(~ mean(., trim = .2), ~ median(., na.rm = TRUE)) ## This warning is displayed once every 8 hours. ## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated. paged_table(EFA_loadings) 3.4 Factor Scores # extract rotated factor scores EFA.scores = factor.scores(vars[,-1], unclass(EFA$loadings))$scores "],["regression-with-5-factors.html", "Chapter4 Regression with 5 Factors", " Chapter4 Regression with 5 Factors # data for regression EFA_with_score &lt;- cbind.data.frame(vars[,2], EFA.scores) %&gt;% dplyr::rename(., mvliking = &quot;vars[, 2]&quot; ) EFA_model &lt;- lm(mvliking ~ PA1 + PA2 +PA3+PA4 +PA5, data=EFA_with_score ) summary(EFA_model) ## ## Call: ## lm(formula = mvliking ~ PA1 + PA2 + PA3 + PA4 + PA5, data = EFA_with_score) ## ## Residuals: ## Min 1Q Median 3Q Max ## -0.7272 -0.0848 -0.0030 0.0900 0.9830 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) -1.05e-16 7.80e-03 0.00 1.0000 ## PA1 1.22e-01 7.81e-03 15.64 &lt;2e-16 *** ## PA2 2.29e-03 7.81e-03 0.29 0.7694 ## PA3 9.80e-01 7.81e-03 125.54 &lt;2e-16 *** ## PA4 3.03e-03 7.81e-03 0.39 0.6983 ## PA5 -2.42e-02 7.81e-03 -3.10 0.0021 ** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.16 on 394 degrees of freedom ## Multiple R-squared: 0.976, Adjusted R-squared: 0.976 ## F-statistic: 3.2e+03 on 5 and 394 DF, p-value: &lt;2e-16 # merge with all previous data #EFA_merge_data &lt;- cbind(microvan, EFA.scores) #head(EFA_merge_data) "],["regression-with-3-factors.html", "Chapter5 Regression with 3 Factors", " Chapter5 Regression with 3 Factors # data for regression EFA_model2 &lt;- lm(mvliking ~ PA1 + PA3 + PA5, data=EFA_with_score ) summary(EFA_model2) ## ## Call: ## lm(formula = mvliking ~ PA1 + PA3 + PA5, data = EFA_with_score) ## ## Residuals: ## Min 1Q Median 3Q Max ## -0.7268 -0.0841 -0.0035 0.0910 0.9816 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) -1.06e-16 7.78e-03 0.00 1.000 ## PA1 1.22e-01 7.79e-03 15.68 &lt;2e-16 *** ## PA3 9.80e-01 7.79e-03 125.82 &lt;2e-16 *** ## PA5 -2.42e-02 7.79e-03 -3.11 0.002 ** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.16 on 396 degrees of freedom ## Multiple R-squared: 0.976, Adjusted R-squared: 0.976 ## F-statistic: 5.36e+03 on 3 and 396 DF, p-value: &lt;2e-16 # merge with all previous data #EFA_merge_data &lt;- cbind(microvan, EFA.scores) #head(EFA_merge_data) "],["clustering.html", "Chapter6 Clustering 6.1 Interpretation of the results", " Chapter6 Clustering EFA_feature = EFA_with_score %&gt;% dplyr::select(PA1, PA2,PA4) # Run a cluster analysis on a distance matrix and using the Ward method c&lt;- hclust(dist(EFA_feature), method=&quot;ward.D2&quot;) # Dendrogram library(dendextend) ## ## --------------------- ## Welcome to dendextend version 1.15.2 ## Type citation(&#39;dendextend&#39;) for how to cite the package. ## ## Type browseVignettes(package = &#39;dendextend&#39;) for the package vignette. ## The github page is: https://github.com/talgalili/dendextend/ ## ## Suggestions and bug-reports can be submitted at: https://github.com/talgalili/dendextend/issues ## You may ask questions at stackoverflow, use the r and dendextend tags: ## https://stackoverflow.com/questions/tagged/dendextend ## ## To suppress this message use: suppressPackageStartupMessages(library(dendextend)) ## --------------------- ## ## Attaching package: &#39;dendextend&#39; ## The following object is masked from &#39;package:data.table&#39;: ## ## set ## The following object is masked from &#39;package:stats&#39;: ## ## cutree plot(set(as.dendrogram(c), &quot;branches_k_color&quot;, # to highlight the cluster solution with a color k = 3), ylab = &quot;Distance&quot;, main = &quot;Dendrogram&quot;, cex = 0.2) set.seed(42) EFA_kmeans &lt;- kmeans(EFA_feature , centers = 3) EFA_kmeans ## K-means clustering with 3 clusters of sizes 118, 157, 125 ## ## Cluster means: ## PA1 PA2 PA4 ## 1 0.70 -1.133 0.013 ## 2 -1.01 -0.038 -0.064 ## 3 0.61 1.117 0.069 ## ## Clustering vector: ## [1] 2 3 1 3 1 1 3 2 1 2 2 1 2 1 3 3 3 3 2 2 2 2 3 2 2 1 2 3 2 1 2 1 2 1 1 ## [36] 1 1 3 1 1 3 2 2 2 2 3 2 1 1 2 1 1 2 1 2 2 3 1 3 2 1 2 2 2 3 2 2 3 3 1 ## [71] 3 2 2 1 1 2 2 1 2 3 1 2 2 2 1 2 2 1 2 2 1 3 2 3 1 1 1 2 2 2 2 1 2 2 2 ## [106] 3 2 3 1 1 3 3 2 3 2 3 3 2 2 2 1 2 3 1 3 2 2 2 3 2 1 1 1 3 3 1 1 1 3 3 ## [141] 3 1 2 2 3 2 3 3 2 2 1 2 3 3 1 2 3 2 1 3 3 1 3 2 2 2 1 1 2 1 3 2 2 3 1 ## [176] 3 1 3 3 1 2 2 3 1 3 2 1 2 2 1 3 1 2 2 3 2 2 3 3 2 3 2 1 2 1 1 2 1 2 3 ## [211] 1 3 2 1 1 2 1 3 2 1 3 2 1 2 1 2 3 2 3 2 2 1 1 1 1 1 1 3 2 3 2 3 3 2 1 ## [246] 2 3 1 2 2 1 2 3 3 3 2 1 2 2 3 1 1 1 3 1 3 2 2 3 2 1 2 1 2 3 1 3 2 2 3 ## [281] 1 3 3 3 1 2 2 1 3 3 3 2 2 3 3 2 1 3 3 1 3 2 1 3 2 1 3 3 1 2 2 2 2 3 2 ## [316] 3 2 3 3 1 2 3 2 3 2 3 2 2 2 3 3 2 1 3 3 2 2 2 3 2 1 1 1 1 1 3 2 3 1 2 ## [351] 3 2 1 2 1 3 3 3 1 3 3 3 2 3 2 2 2 3 3 2 1 1 3 3 3 1 3 2 1 1 3 1 1 3 2 ## [386] 2 1 2 1 2 1 2 3 1 1 2 2 3 3 2 ## ## Within cluster sum of squares by cluster: ## [1] 162 255 207 ## (between_SS / total_SS = 47.9 %) ## ## Available components: ## ## [1] &quot;cluster&quot; &quot;centers&quot; &quot;totss&quot; &quot;withinss&quot; ## [5] &quot;tot.withinss&quot; &quot;betweenss&quot; &quot;size&quot; &quot;iter&quot; ## [9] &quot;ifault&quot; # factor plot fviz_cluster(EFA_kmeans, data = EFA_feature) + theme_bw() 6.1 Interpretation of the results 6.1.1 Histogram 6.1.2 Heatmap # Average for each cluster with one step vars_cluster_agg = aggregate(vars_cluster[, 2:31], by = list(cluster = EFA_kmeans$cluster), FUN = mean) df &lt;- vars_cluster_agg %&gt;% gather(variable, value, -cluster) %&gt;% # to transfrom from wide to long format mutate(variable = fct_rev(factor(variable))) df %&gt;% # to reverse the order of car makes&#39; names on the plot ggplot(aes(x = factor(cluster), y = variable)) + geom_tile(aes(fill = round(value, digits = 2))) + geom_text(aes(label = round(value, digits = 2)), color=&quot;white&quot;) + scale_x_discrete(expand = c(0,0)) + scale_y_discrete(expand = c(0,0)) + scale_fill_gradient(&quot;Average\\n value&quot;, low = &quot;lightgrey&quot;, high = &quot;darkblue&quot;) + theme_minimal() + labs(title = &quot;Average preferences in each cluster&quot;, x = &quot;Cluster&quot;, y = &quot; &quot;) + theme(legend.position=&quot;right&quot;, plot.title = element_text(size = 10, face = &quot;bold&quot;, hjust = 0.5), axis.ticks = element_blank()) "],["demographic.html", "Chapter7 Demographic", " Chapter7 Demographic "],["references.html", "References", " References Reducing Dimensionality Latent Dimensions of Customer Perceptions Hierarchical Clustering Preference Segmentation Preference Segmentation - Validation "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
