[["index.html", "Microvan About", " Microvan Hammond 2022-05-31 About The case describes a project by Grosse Pointe Associates (GPA) investigating the potential market for “microvans”. The objectives of this case are: 1. To give you experience segmenting customers in a market 2. To have you determine which segment(s) would be good to target based on analysis of the data. 3. To have you relate the segment(s) to demographic variables potentially useful for targeting # multivariate analysis and basic descriptive statistics library(psych) # data processing library(dplyr) library(tidyverse) library(data.table) library(DT) # plot library(ggplot2) library(corrplot) library(ggthemes) library(ggridges) # rMarkdown library(rmarkdown) library(kableExtra) # file path management library(here) # stat library(factoextra) "],["executive-summary.html", "Chapter1 Executive Summary", " Chapter1 Executive Summary The case describes a project by Grosse Pointe Associates (GPA) investigating the potential market for “microvans”. The objectives of this case are: 1. To give you experience segmenting customers in a market 2. To have you determine which segment(s) would be good to target based on analysis of the data. 3. To have you relate the segment(s) to demographic variables potentially useful for targeting. "],["explorative-data-analysis.html", "Chapter2 Explorative Data Analysis 2.1 Histogram 2.2 Correlation Analysis", " Chapter2 Explorative Data Analysis # data dataPath = file.path(dataDir, &quot;microvan.csv&quot;) microvan = read.csv(dataPath, sep=&quot;;&quot;) # Convert all integer variables into numeric ones for futher work microvan &lt;- as.data.table(lapply(microvan, as.numeric)) # data description description = psych::describe(microvan) %&gt;% as.data.frame() %&gt;% tibble::rownames_to_column(.,var=&quot;variable&quot;) %&gt;% dplyr::select(vars,everything())%&gt;% dplyr::rename(., &quot;variable id&quot; = &quot;vars&quot;) # columns that need to be formatted numCols = c(&quot;mean&quot;, &quot;sd&quot;, &quot;median&quot; , &quot;trimmed&quot;, &quot;mad&quot;, &quot;min&quot;, &quot;max&quot;, &quot;skew&quot;, &quot;kurtosis&quot;, &quot;se&quot;) DT::datatable( description, rownames = F, fillContainer = T, options = list( pageLength = 10, scrollX = TRUE, scrollY = TRUE ) ) %&gt;% DT::formatRound(columns = numCols , digits = 1) 2.1 Histogram microvan_df = microvan[,2:32] %&gt;% gather() microvan_hist = ggplot(microvan_df, aes(value)) + facet_wrap(~ key, scales = &quot;free&quot;,ncol = 6) + geom_histogram(alpha = 0.5, position = &quot;identity&quot;) + theme_economist_white() +theme(axis.title.x = element_blank()) microvan_hist_path = file.path(plotDir, &quot;microvan_hist.png&quot;) ggsave( filename =microvan_hist_path, plot = microvan_hist, width = 4000, height =4000, units = &quot;px&quot; ) ## `stat_bin()` using `bins = 30`. Pick better value with ## `binwidth`. Figure 2.1: Variable 2-32 2.2 Correlation Analysis 2.2.1 Pair-wise Scatter Plot 2.2.2 Correlation Matrix # plot name corrPlot = file.path(plotDir, &quot;corrPlot.png&quot;) cor_with_mvliking &lt;- cor(vars[,-1]) png( filename = corrPlot, width = 1500, height = 1500 ) corrplot(cor_with_mvliking, method=&quot;number&quot;, type=&quot;upper&quot;, order = &quot;hclust&quot;, # reorder by the size of the correlation coefficients tl.cex = 1.5, # font size of the variable labels tl.col = &quot;black&quot;, # color of the variable labels tl.srt = 45, # rotation angle for the variable labels number.cex = 1.4 # font size of the coefficients ) invisible(dev.off()) "],["exploratory-factor-analysis.html", "Chapter3 Exploratory Factor Analysis 3.1 Eigenvalues 3.2 Extract Principal Factors 3.3 Factor Loadings 3.4 Factor Scores", " Chapter3 Exploratory Factor Analysis 3.1 Eigenvalues # correlation analysis without mvliking cor&lt;- cor(vars[,-1]) EV = eigen(cor)$values EV_df = EV %&gt;% # convert to df as.data.frame()%&gt;% # name column dplyr::rename(., &quot;Eigen Value&quot; =&quot;.&quot;) %&gt;% # add a column &quot;Factor&quot; dplyr::mutate(Factor = seq(1,length(EV))) %&gt;% # order columns dplyr::select(Factor, everything()) %&gt;% # add a column &quot;Variance&quot; dplyr::mutate(`Variance %` = EV/length(EV) *100) %&gt;% dplyr::mutate(`Cumulative Variance % ` = cumsum(EV/length(EV))* 100) %&gt;% dplyr::mutate(., across(where(is.numeric), round, 1)) rmarkdown::paged_table(EV_df ) 3.1.1 Scree Plot psych::scree(cor, pc = TRUE, factors = FALSE) 3.1.2 Cumulative Percentages of Variance # Shares for the cumulative variance explained plot(cumsum(EV/length(EV)), type = &quot;o&quot;, # type of plot: &quot;o&quot; for points and lines &#39;overplotted&#39; col = &quot;darkblue&quot;, pch = 16, # plot symbol: 16 = filled circle cex = 1, # size of plot symbols xlab = &quot;Number of factors&quot;, # a title for the x axis ylab = &quot;Cumulative variance explained&quot;, # a title for the y axis lwd = 2) # line width abline(v = 5, lwd = 2, col = &quot;grey&quot;) # draw a vertical line at v = 3 3.1.3 Select Number of Factors using Kaiser Rule nFactor &lt;- length(which(EV &gt; 1)) print(paste0(nFactor, &quot; factors with Eigenvalue &gt; 1&quot; )) ## [1] &quot;5 factors with Eigenvalue &gt; 1&quot; 3.2 Extract Principal Factors EFA &lt;- psych::fa( r = cor, # number of factors nfactors = nFactor, # principal factor fm = &quot;pa&quot;, # maximizes the sum of the variance of the squared loadings rotate = &quot;varimax&quot; ) 3.3 Factor Loadings columnOrder &lt;- c(&quot;PA1&quot;, &quot;PA2&quot;, &quot;PA3&quot;, &quot;PA4&quot;,&quot;PA5&quot;,&quot;Communality&quot;,&quot;Uniqueness&quot;) EFA_loadings &lt;- data.frame(EFA$loadings[,] ) %&gt;% dplyr::mutate(Uniqueness = EFA$uniquenesses, Communality = EFA$communality) %&gt;% dplyr::mutate(., across(where(is.numeric), round, 2)) %&gt;% dplyr::select(columnOrder) %&gt;% arrange(., -Communality) EFA_loadings_DT = EFA_loadings %&gt;% tibble::rownames_to_column(., var=&quot;variable&quot;) # PA cols PACols = c(&quot;PA1&quot;, &quot;PA2&quot;, &quot;PA3&quot;, &quot;PA4&quot;,&quot;PA5&quot;) # color colfunc &lt;- colorRampPalette(c(&quot;darkblue&quot;, &quot;lightgrey&quot;)) # DT table DT::datatable(EFA_loadings_DT , options = list(pageLength = 15)) %&gt;% formatStyle(&quot;PA1&quot;, backgroundColor = styleEqual(sort(unique(EFA_loadings_DT $PA1), decreasing = TRUE), colfunc(length( unique(EFA_loadings_DT $PA1) )))) %&gt;% formatStyle(&quot;PA2&quot;, backgroundColor = styleEqual(sort(unique(EFA_loadings_DT $PA2), decreasing = TRUE), colfunc(length( unique(EFA_loadings_DT $PA2) )))) %&gt;% formatStyle(&quot;PA3&quot;, backgroundColor = styleEqual(sort(unique(EFA_loadings_DT $PA3), decreasing = TRUE), colfunc(length( unique(EFA_loadings_DT $PA3) )))) %&gt;% formatStyle(&quot;PA4&quot;, backgroundColor = styleEqual(sort(unique(EFA_loadings_DT $PA4), decreasing = TRUE), colfunc(length( unique(EFA_loadings_DT $PA4) )))) %&gt;% formatStyle(&quot;PA5&quot;, backgroundColor = styleEqual(sort(unique(EFA_loadings_DT $PA5), decreasing = TRUE), colfunc(length( unique(EFA_loadings_DT $PA5) )))) %&gt;% formatStyle(PACols, color = &quot;white&quot;) 3.4 Factor Scores # extract rotated factor scores EFA.scores = factor.scores(vars[,-1], unclass(EFA$loadings))$scores DT_cols = c(&quot;PA1&quot;,&quot;PA2&quot;,&quot;PA3&quot;,&quot;PA4&quot;,&quot;PA5&quot;) subjectValue =microvan$subjnumb EFA.scores %&gt;% as.data.frame() %&gt;% mutate(subjnumb = subjectValue )%&gt;% select(subjnumb, everything())%&gt;% head(5) %&gt;% DT::datatable(caption = &quot;Top 5 subjects&quot;,rownames = F) %&gt;% DT::formatRound(columns=DT_cols , digits=2) "],["regression-with-5-factors.html", "Chapter4 Regression with 5 Factors", " Chapter4 Regression with 5 Factors # data for regression EFA_with_score &lt;- cbind.data.frame(vars[,2], EFA.scores) %&gt;% dplyr::rename(., mvliking = &quot;vars[, 2]&quot; ) EFA_model &lt;- lm(mvliking ~ PA1 + PA2 +PA3+PA4 +PA5, data=EFA_with_score ) summary(EFA_model) ## ## Call: ## lm(formula = mvliking ~ PA1 + PA2 + PA3 + PA4 + PA5, data = EFA_with_score) ## ## Residuals: ## Min 1Q Median 3Q Max ## -0.72716 -0.08479 -0.00297 0.09001 0.98302 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) -1.054e-16 7.797e-03 0.000 1.00000 ## PA1 1.221e-01 7.807e-03 15.643 &lt; 2e-16 *** ## PA2 2.291e-03 7.807e-03 0.293 0.76936 ## PA3 9.800e-01 7.807e-03 125.537 &lt; 2e-16 *** ## PA4 3.028e-03 7.807e-03 0.388 0.69830 ## PA5 -2.420e-02 7.807e-03 -3.100 0.00208 ** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.1559 on 394 degrees of freedom ## Multiple R-squared: 0.976, Adjusted R-squared: 0.9757 ## F-statistic: 3203 on 5 and 394 DF, p-value: &lt; 2.2e-16 # merge with all previous data #EFA_merge_data &lt;- cbind(microvan, EFA.scores) #head(EFA_merge_data) "],["regression-with-3-factors.html", "Chapter5 Regression with 3 Factors", " Chapter5 Regression with 3 Factors # data for regression EFA_model2 &lt;- lm(mvliking ~ PA1 + PA3 + PA5, data=EFA_with_score ) summary(EFA_model2) ## ## Call: ## lm(formula = mvliking ~ PA1 + PA3 + PA5, data = EFA_with_score) ## ## Residuals: ## Min 1Q Median 3Q Max ## -0.72678 -0.08413 -0.00353 0.09105 0.98162 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) -1.057e-16 7.780e-03 0.000 1.00000 ## PA1 1.221e-01 7.789e-03 15.678 &lt; 2e-16 *** ## PA3 9.800e-01 7.789e-03 125.817 &lt; 2e-16 *** ## PA5 -2.420e-02 7.789e-03 -3.107 0.00203 ** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.1556 on 396 degrees of freedom ## Multiple R-squared: 0.976, Adjusted R-squared: 0.9758 ## F-statistic: 5362 on 3 and 396 DF, p-value: &lt; 2.2e-16 # merge with all previous data #EFA_merge_data &lt;- cbind(microvan, EFA.scores) #head(EFA_merge_data) "],["clustering.html", "Chapter6 Clustering 6.1 Dendrogram 6.2 K-Means 6.3 Interpretation of the results", " Chapter6 Clustering 6.1 Dendrogram EFA_feature = EFA_with_score %&gt;% dplyr::select(PA1, PA2,PA4) # Run a cluster analysis on a distance matrix and using the Ward method c&lt;- hclust(dist(EFA_feature), method=&quot;ward.D2&quot;) # Dendrogram library(dendextend) plot(set(as.dendrogram(c), &quot;branches_k_color&quot;, # to highlight the cluster solution with a color k = 3), ylab = &quot;Distance&quot;, main = &quot;Dendrogram&quot;, cex = 0.2) 6.2 K-Means set.seed(42) EFA_kmeans &lt;- kmeans(EFA_feature , centers = 3) EFA_kmeans ## K-means clustering with 3 clusters of sizes 118, 157, 125 ## ## Cluster means: ## PA1 PA2 PA4 ## 1 0.6951101 -1.13310118 0.01250923 ## 2 -1.0108796 -0.03774508 -0.06434312 ## 3 0.6134809 1.11705533 0.06900625 ## ## Clustering vector: ## [1] 2 3 1 3 1 1 3 2 1 2 2 1 2 1 3 3 3 3 2 2 2 2 3 2 2 1 2 3 2 1 ## [31] 2 1 2 1 1 1 1 3 1 1 3 2 2 2 2 3 2 1 1 2 1 1 2 1 2 2 3 1 3 2 ## [61] 1 2 2 2 3 2 2 3 3 1 3 2 2 1 1 2 2 1 2 3 1 2 2 2 1 2 2 1 2 2 ## [91] 1 3 2 3 1 1 1 2 2 2 2 1 2 2 2 3 2 3 1 1 3 3 2 3 2 3 3 2 2 2 ## [121] 1 2 3 1 3 2 2 2 3 2 1 1 1 3 3 1 1 1 3 3 3 1 2 2 3 2 3 3 2 2 ## [151] 1 2 3 3 1 2 3 2 1 3 3 1 3 2 2 2 1 1 2 1 3 2 2 3 1 3 1 3 3 1 ## [181] 2 2 3 1 3 2 1 2 2 1 3 1 2 2 3 2 2 3 3 2 3 2 1 2 1 1 2 1 2 3 ## [211] 1 3 2 1 1 2 1 3 2 1 3 2 1 2 1 2 3 2 3 2 2 1 1 1 1 1 1 3 2 3 ## [241] 2 3 3 2 1 2 3 1 2 2 1 2 3 3 3 2 1 2 2 3 1 1 1 3 1 3 2 2 3 2 ## [271] 1 2 1 2 3 1 3 2 2 3 1 3 3 3 1 2 2 1 3 3 3 2 2 3 3 2 1 3 3 1 ## [301] 3 2 1 3 2 1 3 3 1 2 2 2 2 3 2 3 2 3 3 1 2 3 2 3 2 3 2 2 2 3 ## [331] 3 2 1 3 3 2 2 2 3 2 1 1 1 1 1 3 2 3 1 2 3 2 1 2 1 3 3 3 1 3 ## [361] 3 3 2 3 2 2 2 3 3 2 1 1 3 3 3 1 3 2 1 1 3 1 1 3 2 2 1 2 1 2 ## [391] 1 2 3 1 1 2 2 3 3 2 ## ## Within cluster sum of squares by cluster: ## [1] 161.8675 255.1158 206.5558 ## (between_SS / total_SS = 47.9 %) ## ## Available components: ## ## [1] &quot;cluster&quot; &quot;centers&quot; &quot;totss&quot; &quot;withinss&quot; ## [5] &quot;tot.withinss&quot; &quot;betweenss&quot; &quot;size&quot; &quot;iter&quot; ## [9] &quot;ifault&quot; # factor plot fviz_cluster(EFA_kmeans, data = EFA_feature) + theme_bw() 6.3 Interpretation of the results 6.3.1 Heatmap Table # Average for each cluster with one step vars_cluster_agg = aggregate(vars_cluster[, 2:31], by = list(cluster = EFA_kmeans$cluster), FUN = mean) # reshape df &lt;- vars_cluster_agg %&gt;% gather(variable, value, -cluster) # to transfrom from wide to long format library(gt) library(scales) # reshpae, long to wide (cluster ) df_wider = df%&gt;% dplyr::mutate(cluster = paste0(&quot;Cluster&quot;, cluster)) %&gt;% dplyr::mutate(., across(where(is.numeric), round, 2)) %&gt;% spread(., key=cluster, value =value) # cluster columns clusterCols = c(&quot;Cluster1&quot;, &quot;Cluster2&quot;, &quot;Cluster3&quot;) # color colfunc &lt;- colorRampPalette(c(&quot;darkblue&quot;, &quot;lightgrey&quot;)) # DT table DT::datatable(df_wider, options = list(pageLength = 15)) %&gt;% formatStyle(&quot;Cluster1&quot;, backgroundColor = styleEqual(sort(unique(df_wider$Cluster1), decreasing = TRUE), colfunc(length( unique(df_wider$Cluster1) )))) %&gt;% formatStyle(&quot;Cluster2&quot;, backgroundColor = styleEqual(sort(unique(df_wider$Cluster2), decreasing = TRUE), colfunc(length( unique(df_wider$Cluster2) )))) %&gt;% formatStyle(&quot;Cluster3&quot;, backgroundColor = styleEqual(sort(unique(df_wider$Cluster3), decreasing = TRUE), colfunc(length( unique(df_wider$Cluster3) )))) %&gt;% formatStyle(clusterCols, color = &quot;white&quot;) 6.3.2 Histogram df = vars_cluster %&gt;% gather(variable, value, -cluster) %&gt;% as.data.frame() # factorize cluster df$cluster &lt;- factor(df$cluster) # plot vars_cluster_hist = ggplot(df, aes(value, fill = cluster, color = cluster)) + geom_histogram(alpha = 0.3, position = &quot;identity&quot;) + facet_wrap( ~ variable, scales = &quot;free&quot;,ncol = 6) + theme_economist_white() vars_cluster_hist_path = file.path(plotDir, &quot;vars_cluster_hist.png&quot;) ggsave( filename = vars_cluster_hist_path, plot = vars_cluster_hist, width = 3000, height = 3000, units = &quot;px&quot; ) "],["demographic.html", "Chapter7 Demographic 7.1 Histogram 7.2 Ridge plot", " Chapter7 Demographic 7.1 Histogram demo_cluster &lt;- cbind(microvan[,33:39], cluster= EFA_kmeans$cluster) %&gt;% as.data.frame() df = demo_cluster %&gt;% gather(variable, value, -cluster) %&gt;% as.data.frame() # factorize cluster df$cluster &lt;- factor(df$cluster) df$variable &lt;- factor(df$variable, levels = c(&quot;age&quot;, &quot;income&quot;, &quot;miles&quot;, &quot;educ&quot;, &quot;numkids&quot;, &quot;recycle&quot;, &quot;female&quot;)) # plot demo_cluster_hist = ggplot(df, aes(value, fill = cluster, color = cluster)) + geom_histogram(alpha = 0.3, position = &quot;identity&quot;) + facet_wrap( ~ variable, scales = &quot;free&quot;,ncol = 4) + theme_economist_white() demo_cluster_hist_path = file.path(plotDir, &quot;demo_cluster_hist.png&quot;) ggsave( filename = demo_cluster_hist_path, plot = demo_cluster_hist, width = 2400, height = 1800, units = &quot;px&quot; ) 7.2 Ridge plot # ridge plot demo_cluster_ridge = df %&gt;% ggplot( aes(y=cluster, x=value, fill=cluster)) + geom_density_ridges(alpha=0.6, stat=&quot;binline&quot;, bins=20) + facet_wrap( ~ variable, scales = &quot;free&quot;,ncol = 4) + xlab(&quot;&quot;) + ylab(&quot;&quot;) + theme_economist_white() demo_cluster_ridge_path = file.path(plotDir, &quot;demo_cluster_ridge.png&quot;) ggsave( filename = demo_cluster_ridge_path, plot = demo_cluster_ridge, width = 2400, height = 1800, units = &quot;px&quot; ) "],["references.html", "References", " References Reducing Dimensionality Latent Dimensions of Customer Perceptions Hierarchical Clustering Preference Segmentation Preference Segmentation - Validation "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
